"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[67640],{67640:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var i=n(27573),l=n(7653),a=n(3458),s=n(25564),o=n(83154),c=n(21010),r=n(66891);function u(e){let t="",n=(""+e).replace(/\D/g,"").match(10===e.length?s.Oe:s.MW);return n&&(t=n[1]+" "+n[2]+" "+n[3]),t}n(40763),n(14115);var d=n(51436),p=n(90375),m=e=>{let{phone:t,onSubmit:n,onResetFlow:l}=e,{currentPage:a}=(0,p.q)(e=>e),{sendTracking:m}=(0,d.a8)(),h=()=>m(d.W1.CLICK_OTP_VIA_SMS,{screen_location:a,location_name:"popup_login",location_type:"popup"}),x=()=>m(d.W1.CLICK_CHANGE_PHONE_NUMBER,{screen_location:a,location_name:"popup_login",location_type:"popup"});return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center mb:px-4",children:[(0,i.jsx)("h4",{className:"mb-[45px] text-center text-textOnWhitePrimary l6-semibold",children:"Nhận m\xe3 x\xe1c thực"}),(0,i.jsx)(r.default,{src:"/img/receive_authentication.png",alt:"authentication",width:202,height:130}),(0,i.jsx)("p",{className:"mb-1 mt-[45px] text-textOnWhiteSecondary b1-regular",children:"M\xe3 x\xe1c thực được gửi đến số điện thoại"}),(0,i.jsxs)("div",{className:"mb-5 flex",children:[(0,i.jsx)("span",{className:"text-textOnWhitePrimary b1-medium",children:u(t)}),(0,i.jsxs)("button",{className:"ml-4 flex items-center text-textOnWhiteHyperLink b1-medium",onClick:()=>{x(),l()},children:[(0,i.jsx)(o.xdi,{className:"mr-1"})," Đổi số điện thoại"]})]}),(0,i.jsx)("p",{className:"mb-3 text-textOnWhitePrimary",children:"Vui l\xf2ng chọn h\xecnh thức nhận m\xe3"}),(0,i.jsx)(c.default,{backgroundColor:"red-primary",onClick:()=>{h(),n(s._O.sms)},className:"mb-3 w-full rounded-[8px]",size:"large",variant:"icon",children:"Nhận qua SMS"})]})},h=n(60024),x=n(88655),f=n(24945),y=e=>{let{show:t,onSubmit:n}=e;o.oVu,o.QVe,o.jE6,o.ICv;let[a,r]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[y,v]=(0,l.useState)(!1),b=(0,l.useRef)(null),{sendTracking:g}=(0,d.a8)(),{currentPage:N}=(0,p.q)(),j=()=>{g(d.W1.LOGIN_PHONE_NUMBER,{screen_location:N,location_name:"popup_login",location_type:"popup"})};(0,l.useEffect)(()=>{if(t){r("");let e=setTimeout(()=>{var e;null==b||null===(e=b.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}},[t]);let _=async()=>{let e;v(!0);try{e=await (0,h.uI)(a)}catch(e){v(!1);return}v(!1),e&&n(a,e.data.isAccepted)},C=()=>{j();let e=s.$R.test(a)?"":"Số điện thoại kh\xf4ng hợp lệ. Vui l\xf2ng thử lại hoặc đăng nhập bằng h\xecnh thức kh\xe1c.";m(e),e||_()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"mb-3 text-center text-textOnWhitePrimary l6-semibold",children:"Đăng k\xfd / Đăng nhập"}),(0,i.jsx)("p",{className:"mb-5 text-center text-textOnWhiteSecondary b1-regular",children:"Vui l\xf2ng đăng nhập để hưởng những đặc quyền d\xe0nh cho th\xe0nh vi\xean."}),(0,i.jsx)(f.Z,{ref:b,value:a,onChange:e=>{s.Ay.test(e)&&(m(""),r(e))},onKeyDown:e=>{"Enter"===e.key&&C()},size:"medium",allowClear:!0,type:"tel",helperText:(0,i.jsx)(i.Fragment,{children:u&&(0,i.jsx)(x.Z,{text:u,status:"error",className:"".concat(u?"opacity-100":"opacity-0"," mt-1 transition-opacity duration-500 ease-in-out")})}),status:u?"error":"default",maxLength:10,placeholder:"Nhập số điện thoại",classNameInput:"b1-regular"}),(0,i.jsx)(c.default,{disabled:!a.length,backgroundColor:"red-primary",onClick:C,className:"mb-5 mt-3 w-full rounded-[8px]",size:"large",variant:"icon",loading:y,children:"Tiếp tục"})]})},v=n(14546),b=e=>{let{onSuccess:t,handleToggle:n,show:s}=e,[r,u]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s&&u(s)},[s]),(0,l.useEffect)(()=>{n&&n(r)},[r]);let[d,p]=(0,l.useState)(""),[m,x]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=async()=>{p((await (0,h.SP)()).data)};s&&e(),x(!1)},[s]),(0,a.createPortal)((0,i.jsxs)("div",{className:"fixed inset-0 z-[200] flex items-end justify-center transition-all pc:items-center ".concat(r?"visible opacity-100":"invisible opacity-0"),children:[(0,i.jsxs)("div",{className:"z-[202] flex w-full max-w-[600px] flex-col bg-bgGrayDefault px-0 py-0 transition-all  mb:h-full mb:overflow-hidden pc:rounded-2xl",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-1.5 bg-white px-4 py-3",children:[(0,i.jsx)("p",{className:"text-left text-textOnWhitePrimary h5-20-semibold",children:"Th\xf4ng tin"}),(0,i.jsx)("div",{className:"ml-auto flex shrink-0 cursor-pointer items-center justify-center px-0 px-4 py-0 py-3",onClick:()=>u(!1),children:(0,i.jsx)(o.UiA,{})})]}),(0,i.jsx)("div",{className:"h-[300px] grow overflow-y-auto p-4 pb-4 text-textOnWhitePrimary",dangerouslySetInnerHTML:{__html:d}}),(0,i.jsxs)("div",{className:"bg-white p-4 mb:rounded-t-2xl mb:shadow-[0px_2px_24px_0px_rgba(0,0,0,0.08),0px_28px_32px_1px_rgba(0,0,0,0.12)]",children:[(0,i.jsx)("div",{className:"pb-5 text-textOnWhitePrimary",children:(0,i.jsx)(v.Z,{value:"",checked:m,size:"large",onChange:x,className:"items-start",label:"T\xf4i đồng \xfd với điều khoản dịch vụ, ch\xednh s\xe1ch thu thập v\xe0 xử l\xfd dữ liệu c\xe1 nh\xe2n của FPT Shop",labelCheckBoxClassName:"leading-5 text-textOnWhitePrimary"})}),(0,i.jsx)(c.default,{className:"h-11 w-full b2-medium ".concat(!m&&"pointer-events-none"),disabled:!m,onClick:()=>{t(),u(!1)},variant:"icon-square",backgroundColor:"red-primary",size:"large",children:"Tiếp tục"})]})]}),(0,i.jsx)("div",{className:"fixed inset-0 z-[201] cursor-pointer bg-bgSpecialBlackOpacityPressed"})]}),document.body)},g=e=>{let{seconds:t,onFinishCountTime:n,className:a,resetKey:s}=e,[o,c]=(0,l.useState)(t);(0,l.useEffect)(()=>{c(t)},[t,s]),(0,l.useEffect)(()=>{if(!o){n&&n();return}let e=setInterval(()=>{c(o-1)},1e3);return()=>clearInterval(e)},[o]);let r=Math.floor(o/60);return(0,i.jsxs)("span",{className:a,children:[r>0&&"".concat(r," ph\xfat ")," ",o%60," gi\xe2y"]})},N=e=>{let{onChange:t,onEnter:n,className:a,error:o}=e,[c,r]=(0,l.useState)(Array(6).fill(""));(0,l.useEffect)(()=>{let e=setTimeout(()=>{var e,t;null===(t=u[0])||void 0===t||null===(e=t.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)},[]);let u=Array(6).fill(0).map(()=>(0,l.createRef)()),d=(e,n)=>{var i,l;if(!s.Ay.test(e))return;e&&(null===(l=u[n+1])||void 0===l||null===(i=l.current)||void 0===i||i.focus());let a=[...c];e.length>1&&(e=e.replace(a[n],"")),a[n]=e,r(a),t(a)},p=(e,i)=>{if("Backspace"===e.key){var l,a;let e=[...c];e[i]="",r(e),t(e),i>0&&(null===(a=u[i-1])||void 0===a||null===(l=a.current)||void 0===l||l.focus())}"Enter"===e.key&&6===c.filter(e=>e).length&&n&&n(c.join(""))},m=e=>{e.preventDefault();let n=e.clipboardData.getData("text").split("");n.length===c.length&&(r(n),t(n))};return(0,i.jsx)("div",{className:a,children:c.map((e,t)=>(0,i.jsx)(f.Z,{type:"tel",value:e,onKeyUp:e=>p(e,t),onChange:e=>d(e,t),onPaste:m,ref:u[t],className:"h-11 w-11",maxLength:2,classNameInputWapper:"h-11 rounded-[8px]",classNameInput:"l6-semibold cursor-pointer text-center",status:o?"error":"default"},t))})},j=n(1944),_=n(53469),C=e=>{let{onSubmit:t,data:n,otpData:a=s.h6,onResetFlow:r,onResendOtp:m,isBlockResend:f,messageOtp:y}=e,{sessionId:v,mergeCart:b,currentPage:C}=(0,p.q)(e=>e),[S,O]=(0,l.useState)([]),[w,k]=(0,l.useState)(""),[T,E]=(0,l.useState)(!1),[W,P]=(0,l.useState)(!1),[I,A]=(0,l.useState)(!1),[F,z]=(0,l.useState)(a.waitingTimeSecond>0),[L,R]=(0,l.useState)(!(a.expiredOtpTimeSecond>0)),{sendTracking:M}=(0,d.a8)(),D=()=>M(d.W1.CLICK_CONFIRM,{screen_location:C,location_name:"popup_login",location_type:"popup"}),H=()=>M(d.W1.CLICK_CHANGE_PHONE_NUMBER,{screen_location:C,location_name:"popup_login",location_type:"popup"}),K=()=>M(d.W1.CLICK_TRY_AGAIN,{screen_location:C,location_name:"popup_login",location_type:"popup"});(0,l.useEffect)(()=>{y&&k(y)},[y]),(0,l.useEffect)(()=>{E(e=>!e),z(a.waitingTimeSecond>0),R(!(a.expiredOtpTimeSecond>0)),A(!1)},[a]);let V=n.otpType===s._O.zalo,B=async e=>{var i,l,a;D();let s=null!=e?e:S.join(""),o={phoneNumber:n.phoneNumber,otpType:n.otpType,otpCode:s};P(!0);try{await (0,h.x4)(o)}catch(t){let e="Đ\xe3 c\xf3 lỗi xảy ra. Vui l\xf2ng thử lại.";(null==t?void 0:null===(i=t.response)||void 0===i?void 0:i.error_description)?e="M\xe3 x\xe1c thực kh\xf4ng ch\xednh x\xe1c. Vui l\xf2ng thử lại.":"string"==typeof(null==t?void 0:null===(l=t.response)||void 0===l?void 0:l.error)&&(A(!0),e="Bạn đ\xe3 nhập sai m\xe3 x\xe1c thực qu\xe1 5 lần. Vui l\xf2ng nhấn Gửi lai m\xe3 x\xe1c thực cho t\xf4i."),P(!1),k(e);return}try{let e=await (0,j.Ai)(),n=null==e?void 0:e.data;b({sessionId:v,shipmentPrice:0,phoneNumber:"",shopCode:"",customerId:null!==(a=n.customerId)&&void 0!==a?a:""}),t(s,n)}finally{P(!1)}(0,j.f2)()},q=e=>{K(),k(""),m(e)};return(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("h5",{className:"mb-5 text-textOnWhitePrimary l6-semibold",children:"Nhập m\xe3 x\xe1c thực"}),(0,i.jsx)("p",{className:"mb-2 text-textOnWhiteSecondary b2-regular",children:"M\xe3 x\xe1c thực được gửi đến ".concat(V?"t\xe0i khoản Zalo":"số điện thoại")}),(0,i.jsxs)("p",{className:"mb-2 flex text-textOnWhiteSecondary b2-regular",children:[(0,i.jsx)("span",{className:"text-textOnWhitePrimary b2-medium",children:u(n.phoneNumber)}),(0,i.jsx)("span",{className:"mx-1",children:L?"đ\xe3 hết hiệu lực":"c\xf3 hiệu lực trong"}),(0,i.jsx)(g,{className:" b2-medium ".concat(L?"hidden":""),seconds:a.expiredOtpTimeSecond,onFinishCountTime:()=>R(!0),resetKey:T})]}),(0,i.jsxs)("button",{className:"mb-5 flex items-center text-textOnWhiteHyperLink b1-medium",onClick:()=>{H(),r()},disabled:W,children:[(0,i.jsx)(o.xdi,{className:"mr-1"})," Đổi số điện thoại"]}),(0,i.jsx)(N,{className:"flex justify-around gap-2",onChange:e=>{k(""),O(e)},onEnter:B,error:w}),w&&(0,i.jsx)(x.Z,{text:w,status:"error",className:"".concat(w?"opacity-100":"opacity-0"," mt-2 transition-opacity duration-500 ease-in-out")}),(0,i.jsx)(c.default,{className:"mb-3 mt-5 w-full rounded-[8px] b2-medium ".concat((S.join("").length<6||f||I)&&"pointer-events-none"),onClick:()=>B(),size:"large",disabled:S.join("").length<6||f||I,loading:W,children:"X\xe1c nhận"}),(0,i.jsx)("div",{className:(0,_.Z)("mb-2 flex items-center",{hidden:f}),children:(0,i.jsxs)("button",{className:"flex items-center b1-medium ".concat(F?"pointer-events-none text-textOnWhiteDisable":"text-textOnWhiteHyperLink"),onClick:()=>q(),children:[(0,i.jsx)(o.eYY,{className:"mr-1",color:F?"#9CA3AF":"#1250DC"})," ","Gửi lại m\xe3 x\xe1c thực",(0,i.jsxs)("span",{className:F?"ml-1 inline-flex b1-medium":"hidden",children:["(",(0,i.jsx)(g,{seconds:a.waitingTimeSecond,onFinishCountTime:()=>z(!1),resetKey:T}),")"]})]})})]})},S=e=>{let{onSuccess:t,handleToggle:n,show:c}=e,[r,u]=(0,l.useState)(!1),[x,f]=(0,l.useState)(s.t3),[v,g]=(0,l.useState)(),[N,j]=(0,l.useState)(!1),[_,S]=(0,l.useState)(""),[O,w]=(0,l.useState)(0),[k,T]=(0,l.useState)(s.FC.login),[E,W]=(0,l.useState)(!1),{sendTracking:P}=(0,d.a8)(),{currentPage:I}=(0,p.q)(),A=()=>{P(d.W1.CLICK_CLOSE,{screen_location:I,location_name:"popup_login",location_type:"popup"})};(0,l.useEffect)(()=>{c&&u(c)},[c]),(0,l.useEffect)(()=>{f(s.t3),T(s.FC.login)},[r]),(0,l.useEffect)(()=>(r&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[r]);let F=(e,t)=>{let n={...x};n[e]=t,f(n)},z=(e,t,n)=>{F(t,n),T(e)},L=()=>{f(s.t3),T(s.FC.login)},R=async e=>{let t={fromSys:s.VN.fromSys,otpType:null!=e?e:x.otpType,phoneNumber:x.phoneNumber};g(await (0,h.Jp)(t))},M=async e=>{try{j(!1),S(""),await R(e)}catch(e){var t,n,i,l,a,o;(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.error)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:null===(t=n.OTP)||void 0===t?void 0:t.sendOtpQuantity)>=5&&j(!0),S((null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(a=o.error)||void 0===a?void 0:a.message)||"")}z(s.FC.otp,"otpType",e)},D=async(e,i)=>{F("otp",e),u(!1),t&&t(i),n&&n(!1)},H=async e=>{try{j(!1),S(""),await R(e),w(e=>++e)}catch(e){var t,n,i,l,a,s;(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.error)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:null===(t=n.OTP)||void 0===t?void 0:t.sendOtpQuantity)>=5&&j(!0),S((null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(a=s.error)||void 0===a?void 0:a.message)||"")}void 0!==e&&e!==x.otpType&&F("otpType",e)},K={method:(0,i.jsx)(m,{phone:x.phoneNumber,onSubmit:M,onResetFlow:L}),otp:(0,i.jsx)(C,{data:x,otpData:v,onSubmit:D,onResetFlow:L,onResendOtp:H,isBlockResend:N,messageOtp:_},O),login:(0,i.jsx)(y,{show:c,onSubmit:(e,t)=>{t?z(s.FC.method,"phoneNumber",e):(F("phoneNumber",e),W(!0))}})};return(0,a.createPortal)((0,i.jsx)(d.zU,{base:{location_name:d.Oy.HEADER},children:(0,i.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center pc:transition-all ".concat(r?"visible opacity-100":"invisible opacity-0"),children:[(0,i.jsxs)("div",{className:"z-[102] flex w-full flex-col bg-white py-3 transition-all mb:h-full pc:max-w-[400px] pc:rounded-2xl",children:[(0,i.jsx)("div",{className:"ml-auto flex shrink-0 cursor-pointer items-center justify-center px-4 py-3",onClick:()=>{A(),u(!1),n&&n(!1)},children:(0,i.jsx)(o.UiA,{})}),(0,i.jsx)("div",{className:"px-4 pb-5 pc:px-9 pc:pb-16",children:K[k]}),(0,i.jsx)(b,{show:E,handleToggle:W,onSuccess:()=>{T(s.FC.method)}})]}),(0,i.jsx)("div",{className:"fixed inset-0 z-[101] cursor-pointer bg-bgSpecialBlackOpacityPressed"})]})}),document.body)}}}]);